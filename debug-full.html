<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>å®Œæ•´è°ƒè¯•ä¿¡æ¯</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; line-height: 1.6; }
        .section { background: #f9f9f9; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .pass { color: green; font-weight: bold; }
        .fail { color: red; font-weight: bold; }
        .warn { color: orange; font-weight: bold; }
        .info { color: blue; }
        pre { background: #f0f0f0; padding: 10px; overflow-x: auto; border-radius: 3px; }
        code { background: #e8e8e8; padding: 2px 6px; border-radius: 3px; }
    </style>
</head>
<body>
    <h1>ğŸ” Moltbot Site å®Œæ•´è°ƒè¯•</h1>
    <div id="output"></div>

    <script>
        const output = document.getElementById('output');

        function addSection(title, content) {
            output.innerHTML += `<div class="section"><h3>${title}</h3>${content}</div>`;
        }

        async function fullDebug() {
            // Section 1: Environment
            addSection('1. ç¯å¢ƒ', `
                <div>JavaScript: <span class="pass">âœ… å·²å¯ç”¨</span></div>
                <div>å½“å‰æ—¶é—´: ${new Date().toLocaleString('zh-CN')}</div>
                <div>User Agent: <code>${navigator.userAgent}</code></div>
            `);

            // Section 2: File access
            addSection('2. æ–‡ä»¶è®¿é—®', `
                <div>æµ‹è¯• /data/config.json: <span id="test-config">...</span></div>
                <div>æµ‹è¯• /data/categories.json: <span id="test-categories">...</span></div>
                <div>æµ‹è¯• /data/news/2026-01.json: <span id="test-news">...</span></div>
                <div>æµ‹è¯• /data/skills/development.json: <span id="test-skills">...</span></div>
            `);

            // Test config
            try {
                const configRes = await fetch('/data/config.json');
                const config = await configRes.json();
                document.getElementById('test-config').innerHTML = `<span class="pass">âœ…</span> ${config.config?.site?.title || 'N/A'}`;
            } catch (e) {
                document.getElementById('test-config').innerHTML = `<span class="fail">âŒ ${e.message}</span>`;
            }

            // Test categories
            try {
                const catsRes = await fetch('/data/categories.json');
                const cats = await catsRes.json();
                document.getElementById('test-categories').innerHTML = `<span class="pass">âœ…</span> ${Object.keys(cats || {}).length} categories`;
            } catch (e) {
                document.getElementById('test-categories').innerHTML = `<span class="fail">âŒ ${e.message}</span>`;
            }

            // Test news
            try {
                const newsRes = await fetch('/data/news/2026-01.json');
                const news = await newsRes.json();
                document.getElementById('test-news').innerHTML = `<span class="pass">âœ…</span> ${news.items?.length || 0} items`;
            } catch (e) {
                document.getElementById('test-news').innerHTML = `<span class="fail">âŒ ${e.message}</span>`;
            }

            // Test skills
            try {
                const skillRes = await fetch('/data/skills/development.json');
                const skill = await skillRes.json();
                document.getElementById('test-skills').innerHTML = `<span class="pass">âœ…</span> ${skill.skills?.length || 0} skills`;
            } catch (e) {
                document.getElementById('test-skills').innerHTML = `<span class="fail">âŒ ${e.message}</span>`;
            }

            // Section 3: JavaScript modules
            addSection('3. JavaScript æ¨¡å—', `
                <div>dataLoader: <span id="test-dataloader">...</span></div>
                <div>renderNews: <span id="test-rendernews">...</span></div>
                <div>renderSkills: <span id="test-renderskills">...</span></div>
            `);

            // Test dataLoader
            if (typeof dataLoader !== 'undefined') {
                document.getElementById('test-dataloader').innerHTML = `<span class="pass">âœ… å·²åŠ è½½</span>`;

                try {
                    const allData = await dataLoader.loadAll();
                    addSection('4. æ•°æ®åŠ è½½å™¨æµ‹è¯•', `
                        <div>loadAll(): <span class="pass">âœ… æˆåŠŸ</span></div>
                        <div>News items: ${allData.news?.items?.length || 0}</div>
                        <div>News count: ${allData.news?.count || 0}</div>
                        <div>Skills: ${allData.skills?.skills?.length || 0}</div>
                        <div>Categories: ${Object.keys(allData.skills?.categories || {}).length}</div>
                        <div>Timestamp: ${allData.timestamp || 'N/A'}</div>
                        ${allData.news?.errors?.length ? `<div class="fail">News errors: ${allData.news.errors.length}</div>` : ''}
                        ${allData.skills?.errors?.length ? `<div class="fail">Skills errors: ${allData.skills.errors.length}</div>` : ''}
                    `);
                } catch (e) {
                    addSection('4. æ•°æ®åŠ è½½å™¨æµ‹è¯•', `<span class="fail">âŒ loadAll() å¤±è´¥: ${e.message}</span>`);
                }
            } else {
                document.getElementById('test-dataloader').innerHTML = `<span class="fail">âŒ æœªåŠ è½½</span>`;
            }

            // Test render functions
            if (typeof renderNews === 'function') {
                document.getElementById('test-rendernews').innerHTML = `<span class="pass">âœ… å·²åŠ è½½</span>`;
            } else {
                document.getElementById('test-rendernews').innerHTML = `<span class="fail">âŒ æœªåŠ è½½</span>`;
            }

            if (typeof renderSkills === 'function') {
                document.getElementById('test-renderskills').innerHTML = `<span class="pass">âœ… å·²åŠ è½½</span>`;
            } else {
                document.getElementById('test-renderskills').innerHTML = `<span class="fail">âŒ æœªåŠ è½½</span>`;
            }

            // Section 5: Console messages
            addSection('5. æ“ä½œ', `
                <p>è¯·æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å° (F12) æŸ¥çœ‹ï¼š</p>
                <ul>
                    <li>JavaScript é”™è¯¯</li>
                    <li>ç½‘ç»œè¯·æ±‚å¤±è´¥</li>
                    <li>console.log è¾“å‡º</li>
                </ul>
                <p>å¦‚æœ‰é”™è¯¯ï¼Œè¯·æˆªå›¾å¹¶å‘é€ç»™å¼€å‘è€…ã€‚</p>
            `);
        }

        fullDebug();
    </script>
</body>
</html>
